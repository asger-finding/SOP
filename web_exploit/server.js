const http = require('http');
const fs = require('fs');

const server = http.createServer((req, res) => {
	if (req.url === '/') {
		res.writeHead(200, {
			'Content-Type': 'text/html'
		});

		res.end(fs.readFileSync('index.html'));
		return;
	}
	
	const url = new URL(req.url, `http://${req.headers.host}`);
	if (url.pathname.startsWith('/spin')) {
		const bet = parseInt(url.searchParams.get('bet')) || null;
		const result = Math.random();
		const number = Math.floor(result * 36) + 1;
		const rotation = result * 360
		const won = bet === number;
		
		res.writeHead(200, { 'Content-Type': 'application/json' });
		res.end(JSON.stringify({ number, rotation, bet, won }));
		return;
	}

	res.end("{}")
});

server.listen(3000, () => {
	console.log('Server kører på http://localhost:3000');
});
